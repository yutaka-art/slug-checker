<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GitHub 利用可否チェック</title>
  <style>
    body { font: 16px/1.6 system-ui, -apple-system, "Segoe UI", Roboto, "Hiragino Sans", "Noto Sans JP", sans-serif; padding: 24px; max-width: 720px; margin: auto; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; margin: 16px 0; }
    .row { display: flex; gap: 8px; margin-top: 8px; }
    input[type=text] { flex: 1; padding: 10px; border: 1px solid #bbb; border-radius: 8px; }
    button { padding: 10px 14px; border: 0; border-radius: 8px; cursor: pointer; background: #24292f; color: #fff; }
    .muted { color: #666; font-size: 0.9em; }
    .ok { color: #067d00; font-weight: bold; }
    .ng { color: #b30000; font-weight: bold; }
    .note { background: #f6f8fa; padding: 10px; border-radius: 8px; }
  </style>
</head>

<body>
  <h1>GitHub 利用可否チェック</h1>

  <!-- GitHub ユーザー名 -->
  <div class="card">
    <h2>GitHub ユーザー名</h2>
    <p class="muted">英数字とハイフン（先頭/末尾ハイフン不可、最大39文字）。</p>
    <div class="row">
      <input id="username" type="text" placeholder="例: acme-dev" />
      <button id="btnUser">チェック</button>
    </div>
    <p id="userResult"></p>
  </div>

  <!-- Enterprise slug（純静的：目視確認導線） -->
  <div class="card">
    <h2>Enterprise slug（存在確認）</h2>
    <p class="note">
      純静的ページからは CORS 制約により自動判定ができません。<br/>
      下のボタンで <code>https://github.com/enterprises/&lt;slug&gt;</code> を開き、<b>404（Not Found）</b> かどうかを目視で確認してください。
    </p>
    <div class="row">
      <input id="slug" type="text" placeholder="例: acme-enterprise" />
      <button id="btnSlugOpen">ページを開く</button>
    </div>
    <p class="muted">※ 404 → 未使用の可能性大。ページが表示される/サインインに誘導 → 使用中。</p>
  </div>

  <script>
    // --- GitHub ユーザー名チェック（API, CORS可） ---
    const userInput = document.getElementById('username');
    const userBtn = document.getElementById('btnUser');
    const userResult = document.getElementById('userResult');

    function isValidUsername(u) {
      // 先頭/末尾ハイフン不可、英数ハイフン、1-39 文字
      return /^[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,37}[a-zA-Z0-9])?$/.test(u);
    }

    userBtn.addEventListener('click', async () => {
      const u = userInput.value.trim();
      userResult.textContent = '';
      if (!isValidUsername(u)) {
        userResult.innerHTML = '<span class="ng">形式エラー:</span> 英数字とハイフンのみ／先頭末尾ハイフン不可／最大39文字';
        return;
      }
      userBtn.disabled = true; userBtn.textContent = 'チェック中…';
      try {
        const resp = await fetch(`https://api.github.com/users/${encodeURIComponent(u)}`, { method: 'GET' });
        if (resp.status === 200) {
          userResult.innerHTML = `👀 <span class="ng">利用できません</span>（既に存在）`;
        } else if (resp.status === 404) {
          userResult.innerHTML = `✅ <span class="ok">利用できます</span>（未存在の可能性が高い）`;
        } else {
          userResult.innerHTML = `⚠️ 不明（HTTP ${resp.status}）。時間をおいて再試行してください。`;
        }
      } catch (e) {
        userResult.textContent = `通信エラー: ${e}`;
      } finally {
        userBtn.disabled = false; userBtn.textContent = 'チェック';
      }
    });

    // --- Enterprise slug：純静的は目視導線のみ（CORSのため） ---
    const slugInput = document.getElementById('slug');
    const slugBtn = document.getElementById('btnSlugOpen');
    slugBtn.addEventListener('click', () => {
      const s = slugInput.value.trim();
      if (!s) return;
      const url = `https://github.com/enterprises/${encodeURIComponent(s)}`;
      window.open(url, '_blank', 'noopener,noreferrer');
    });
  </script>
</body>
</html>
